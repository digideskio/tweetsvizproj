/**
 * pass keyword to server then return query results
 */
$(document).ready(function() {
	$('#search').click(function(event) {
		var keyword = $('#keyword').val();
		$.get('TweetsVizJSPServlet', {
			keyword : keyword
		}, function(responseText) {
			// $('#tempresults').text(responseText);
			// var theString = "[1,6,5] [8,7,9] [1,3,4] [4,6,8] [5,7,7] [6,9,6] [7,0,5] [2,3,3] [3,9,8] [3,6,5] [4,9,4] [2,3,3] [6,9,9] [0,7,0] [7,7,9] [7,2,9] [0,6,2] [4,6,7] [3,7,7] [0,1,7] [2,8,6] [2,3,7] [6,4,8] [3,5,9] [7,9,5] [3,1,7] [4,4,2] [3,6,2] [3,1,6] [6,8,5] [6,6,7] [4,1,1] [7,2,7] [7,7,0] [8,8,9] [9,4,1] [8,3,4] [9,8,9] [3,5,3] [0,2,4] [6,0,2] [2,1,3] [5,8,9] [2,1,1] [9,7,6] [3,0,2] [9,9,0] [3,4,8] [2,6,1] [8,9,2] [7,6,5] [6,3,1] [9,3,1] [8,9,3] [9,1,0] [3,8,7] [8,0,0] [4,9,7] [8,6,2] [4,3,0] [2,3,5] [9,1,4] [1,1,4] [6,0,2] [6,1,6] [3,8,8] [8,8,7] [5,5,0] [3,9,6] [5,4,3] [6,8,3] [0,1,5] [6,7,3] [8,3,2] [3,8,3] [2,1,6] [4,6,7] [8,9,9] [5,4,2] [6,1,3] [6,9,5] [4,8,2] [9,7,4] [5,4,2] [9,6,1] [2,7,3] [4,5,4] [6,8,1] [3,4,0] [2,2,6] [5,1,2] [9,9,7] [6,9,9] [8,4,3] [4,1,7] [6,2,5] [0,4,9] [3,5,9] [6,9,1] [1,9,2] ";
			// var theString = "[7.566666488340723,6.527046868180062,6.057420093320665] [6.379086598050507,5.236117352535413,4.939241762551757] [7.192229631943462,5.8965271476545515,5.6754245365240905] [5.874629182788698,6.524282918813984,4.193688634799407] [4.033333418881837,5.007548112448404,4.404067715079175] [7.387364252997785,6.304851376778204,5.900080524307054] [6.621757412549669,5.503125875101829,5.491879443065261] [6.587853251341104,5.331694182855939,5.612105148320714] [5.701593136517868,4.9006907884133994,5.456216768796937] [8.068695687504032,6.528935609155156,6.671793544638383] [5.313645833766918,5.091903430680179,4.458323879796783] [7.184647916579289,5.761345192279794,5.6712655263337] [6.041485109122926,4.813421125915021,5.430857766542105] [7.067720300576974,4.836961245969329,5.915120475155184] [6.553963186221539,5.712055717601273,5.506712794769625] [7.082264384885865,6.024065792000592,6.031497248834474] [5.313645833766918,5.091903430680179,4.458323879796783] [5.418749375369375,4.234574198685766,4.997025541123306] [5.441630204947418,5.140865870258252,4.65302913797015] [5.530901086974427,4.4640023401032725,5.041849591383747] [7.581914698686779,5.36787338324384,5.6975648916708845] [6.587853251341104,5.331694182855939,5.612105148320714] [5.4472576037465705,4.564300704679092,5.121783206920468] [6.24677401340715,4.833564821889923,5.131935597000421] [7.437793369744643,5.85975323136071,5.83409179989827] [6.420756773801309,4.7490864458885,6.0190383037985224] [7.385041850471815,6.083151622882308,5.839015206400061] [5.508656971486368,4.662679036751536,5.139079909492019] [5.605300537454394,4.797856762393206,5.038406516169841] [5.168865933517837,5.084352088394899,5.050492495461744] [2.2337815161063856,6.2297230476344545,3.1913730026180875] [4.336350526692672,5.9440870672016395,4.531782870906533] [5.791157897036052,4.432733722929485,5.279252308530571] [8.133143094135095,6.641229829147587,6.655661726499354] [5.936559531929513,5.11343025001641,5.644759323821109] [8.16513204044785,6.058478598682971,6.547878924107969] [7.654851555571083,6.315413586978835,5.882424282918181] [7.225379258857756,5.996452903505891,5.962451528009342] [7.464769926217055,5.7785471608441545,6.445862917857678] [5.530901086974427,4.4640023401032725,5.041849591383747] [5.386156473495507,4.80565231165273,5.025999927520752] [5.6038596612575535,5.544609904065899,5.049879604070269] [7.147483823749286,5.458362558420033,5.834279922026374] [7.610275207600522,5.50270844997857,6.267603147724711] [7.026535020474581,5.335761302777602,5.491831846096531] [4.9066202484597605,5.739881805889403,5.23654100594984] [5.626782846574225,5.020800786225957,5.262237358619237] [7.026535020474581,5.335761302777602,5.491831846096531] [7.969342735537497,6.43809989120355,6.0915279245273] [6.614269662454197,4.93784939554995,5.8332000339508046] [5.530901086974427,4.4640023401032725,5.041849591383747] [6.512019024512119,5.836550944621671,5.185437105602914] [5.492796153399991,4.5336401908595745,5.089917290399895] [6.266075411491354,5.225454525398172,5.757060573814445] [7.515413132439772,5.451215871791958,5.83185058578811] [4.785106858840105,5.118222131513273,4.468730637117753] [5.530901086974427,4.4640023401032725,5.041849591383747] [7.07000009230205,5.334665346180273,5.847712589939063] [2.2337815161063856,6.2297230476344545,3.1913730026180875] [7.581914698686779,5.36787338324384,5.6975648916708845] [6.379086598050507,5.236117352535413,4.939241762551757] [7.387364252997784,6.304851376778206,5.900080524307054] [7.385041850471815,6.083151622882308,5.839015206400061] [7.143898356827263,5.238601582361872,5.999166631320903] [2.4183491679670235,5.753471853284974,3.905167583202851] [6.649735637680412,4.877659843042681,5.857209927600351] [5.6038596612575535,5.544609904065899,5.049879604070269] [6.869789295645632,4.3156351883337685,5.451999927613792] [4.032219606103061,5.599817633713165,4.040387042245313] [7.354384469972417,6.047436090331077,6.136337548103275] [6.752734156643475,5.285304550901361,5.858771952730068] [5.635514689272091,5.123665277102939,5.54615779786667] [5.21988800934672,4.445036853964371,5.331500005204428] [7.062187304914308,5.1783572208324005,6.097787359313767] [7.105914001391882,5.534858717691102,6.1017405114025784] [7.105914001391882,5.534858717691102,6.1017405114025784] [7.89366535920294,5.2232697526279415,6.349149229299546] [6.519940013000949,4.992573154576591,5.764345369431407] [7.026535020474581,5.335761302777602,5.491831846096531] [5.313645833766918,5.091903430680179,4.458323879796783] [6.635998368404507,4.538376359321336,5.358076976570276] [7.105914001391882,5.534858717691102,6.1017405114025784] [5.530901086974427,4.4640023401032725,5.041849591383747] [5.772984218144507,4.390244024325383,5.525000095367432] [4.581314543660178,4.840909220734445,5.003201480905598] [5.441630204947418,5.140865870258252,4.65302913797015] [3.9508384436976973,4.088700413391026,4.53248086222891] [2.2337815161063856,6.2297230476344545,3.1913730026180875] [6.986424586083208,5.605476546526596,5.619388198632452] [6.913171323115462,5.310198977218481,5.75782203501923] [6.213216814378511,4.7554545410971425,5.929333398183189] [5.853200063832598,5.089301687720483,5.382282310085628] [5.530901086974427,4.4640023401032725,5.041849591383747] [4.833089046682045,5.387721480362088,5.292790748459682] [6.238379484335031,5.7655747202230465,5.47706755882892] [6.620480330034314,5.644138511205793,5.57602606355973] [7.192229631943462,5.8965271476545515,5.6754245365240905] [2.2337815161063856,6.2297230476344545,3.1913730026180875] [6.750238205395635,5.137849243518097,5.661080640107565] [2.2337815161063856,6.2297230476344545,3.1913730026180875] [7.16003259838078,5.616945701800367,6.33071640537458] [5.113333225250244,5.473587887099754,5.310339373007079] [5.6125345525056245,5.021502893942135,4.897826068770905] [6.799847005946356,5.18866864860692,6.472368396300182] [5.772984218144507,4.390244024325383,5.525000095367432] [6.842437021931505,5.183118607088256,5.8482461030062485] [3.9985233727492036,4.7822014443810765,4.450351005427541] [6.03815530281128,4.825701065890017,5.301142800460277] [5.678114397568034,5.73756228990564,5.554707263155831] [6.062878906706315,4.899350656186736,5.335564188602452] [7.387364252997784,6.304851376778206,5.900080524307054] [6.4924760166384665,5.143899677965774,5.571210471521619] [5.652732495300417,5.016314989388073,5.3289127307277155] [6.233663360349875,5.2856553276005815,5.928881542742153] [5.9795941709419465,5.184991564537077,5.531015432125746] [5.441630204947418,5.140865870258252,4.65302913797015] [7.577949524846268,5.759650483450595,6.082813995144418] [6.944194188703042,5.253838599374327,5.549509190361711] [6.147747230576435,4.79970818054489,5.147705749159976] [5.386156473495507,4.80565231165273,5.025999927520752] [5.796230321369205,5.424566716297191,5.246260378118001] [6.658423491720743,5.3100248797311975,5.83436340210828] [6.237020503470414,4.69071130306079,5.672782091000246] [6.370246639375752,5.031662078000871,5.544768455791876] [5.441630204947418,5.140865870258252,4.65302913797015] [3.293018289865241,4.829890979665092,3.8047754309001816] [2.9464286830173414,5.561089602806694,4.556327010405174] [4.313806713204629,5.2058526047092935,4.358543002248871] [6.695621403863808,5.806973099087921,5.287597152888469] [7.634166538473909,6.018489299628263,6.482753135551187] [5.402088665627564,5.103706752980342,5.431428546634431] [5.441630204947418,5.140865870258252,4.65302913797015] [8.237973693523946,7.067007682760363,6.893880567096021] [7.023185587246913,5.002105311343546,5.853469781098994] [6.379086598050507,5.236117352535413,4.939241762551757] [6.544148642291091,6.063874087330241,5.580000162124634] [7.071588324417443,5.924895073191409,5.8626953297207125] [5.146102016898777,5.282261125110289,4.947297849542303] [5.652732495300417,5.016314989388073,5.3289127307277155] [7.587315902948989,6.249700309889976,6.242600523994417] [5.767518897028769,6.142702495283244,5.509034047751934] [5.386156473495507,4.80565231165273,5.025999927520752] [6.142683009194308,5.419591415486817,5.795252466357469] [6.207226519236146,6.065388134759107,5.712661373772294] [6.932365102795869,5.114513963392953,6.007162283992486] [2.2337815161063856,6.2297230476344545,3.1913730026180875] [7.387364252997785,6.304851376778204,5.900080524307054] [5.839594237412095,4.885386499880562,5.477195186567796] [8.18625016724691,5.204448694910944,6.302483170973567] [5.6612461232879685,5.504964710821748,5.14098384995158] [6.730309930785206,4.749103329028141,5.3972467828630695] [7.387364252997784,6.304851376778206,5.900080524307054] [2.7522222092950055,5.186807155475504,3.232289173932185] [5.6612461232879685,5.504964710821748,5.14098384995158] [5.441630204947418,5.140865870258252,4.65302913797015] [3.9951860750416652,5.225955676432749,3.978871602149114] [5.402088665627564,5.103706752980342,5.431428546634431] [5.903912297673483,5.490794564268302,5.246986866334975] [5.441630204947418,5.140865870258252,4.65302913797015] [5.390106175142415,5.027881454120967,5.219659055494663] [5.213917067855372,5.4796114574380965,4.933524182597945] [5.772984218144507,4.390244024325383,5.525000095367432] [6.5774067840304395,5.228461591577961,5.265871297889098] [5.441630204947418,5.140865870258252,4.65302913797015] [5.615034971937963,4.454045311604137,5.022746118535573] [4.458093362561409,5.684220926685023,4.580719389682737] [5.313645833766918,5.091903430680179,4.458323879796783] [6.584309437815255,5.368886781790452,6.556076500562682] [4.691996546772484,5.449630395013932,4.84087626503921] [3.2603915903234926,4.345323373731675,4.052208555323679] [6.620480330034314,5.644138511205793,5.57602606355973] [5.313645833766918,5.091903430680179,4.458323879796783] [8.37357160233982,6.193411284116058,6.200154598039169] [6.501194186985002,5.449560907818884,5.70309651620332] [7.143898356827263,5.238601582361872,5.999166631320903] [6.698011586669042,6.172224591414494,5.197887401956655] [4.924767296205391,4.606855669650954,4.811430039499867] [5.741605435224118,4.768657076228526,5.185052033297552] [4.703197984455351,5.92425794453907,5.217763633098854] [5.441630204947418,5.140865870258252,4.65302913797015] [5.3196038932101954,4.515814093166328,4.603569638558331] [6.0817132987436615,5.174397978734684,5.563683020062062] [4.875807721853505,4.13211014916746,4.759869996273161] [6.2564235921069224,4.924051483442976,5.67270568213296] [7.625492407319056,4.651499645654919,5.841833968237801] [6.25602413812807,5.083265797359384,5.925589068763764] [7.023185587246913,5.002105311343546,5.853469781098994] [4.694617616917804,4.236997709899996,4.730957077173211] [6.238104267772603,5.288253073592422,5.549332022297311] [7.086212157862274,5.275956767871212,5.76356157459642] [2.19012291571168,4.719780880848916,4.017603669470557] [5.530901086974427,4.4640023401032725,5.041849591383747] [7.465018367316506,5.3620824054699705,6.594299196011198] [6.280890045815632,4.378723456846275,5.290413186504713] [6.365621594060852,4.084602855030871,5.186159560410851] [5.441630204947418,5.140865870258252,4.65302913797015] [6.939937432710962,5.654077241245554,5.800073277674252] [6.379086598050507,5.236117352535413,4.939241762551757] [5.838736862009141,4.789268962479864,5.921798191801882] [5.441630204947418,5.140865870258252,4.65302913797015] [3.069388181682121,4.784101730428946,4.0372695838859975] [5.808381955520578,4.833040460637592,5.361394189536543] [5.441630204947418,5.140865870258252,4.65302913797015] [7.44890890052102,5.710511634188551,6.16572426929022] [6.815974501380743,5.86440455679633,5.472971194578988] [7.387364252997784,6.304851376778206,5.900080524307054] [5.441630204947418,5.140865870258252,4.65302913797015] [7.848889088336331,5.386802917277939,5.77181820687731] [7.609608289250207,6.059724647897374,6.409519479254953] [5.84303364263903,4.719898898289431,5.79692564171828] [4.973379452538769,6.271083326608769,4.676340862496323] [5.599462254733426,5.18179251527296,4.965084806955723] [6.379086598050507,5.236117352535413,4.939241762551757] [4.704404385541333,5.415010305177777,4.676308788068133] [5.3196038932101954,4.515814093166328,4.603569638558331] [4.815558069601104,3.9300000667572017,4.815317701990459] [4.147438075163974,5.639247318919692,4.940516494169583] [6.055439925327606,4.109592655499222,5.227250648462534] [5.386156473495507,4.80565231165273,5.025999927520752] [4.865759068180314,4.797155378373403,4.879313314030637] [6.379086598050507,5.236117352535413,4.939241762551757] [6.379086598050507,5.236117352535413,4.939241762551757] [5.652732495300417,5.016314989388073,5.3289127307277155] [5.313645833766918,5.091903430680179,4.458323879796783] [6.379086598050507,5.236117352535413,4.939241762551757] [5.058792514010965,5.325186800701367,4.978688380693242] [5.441630204947418,5.140865870258252,4.65302913797015] [7.443331376342545,5.734688236949019,6.020748832322552] [4.865759068180314,4.797155378373403,4.879313314030637] [6.998091783010836,5.744626215604403,6.338021569542241] [5.313645833766918,5.091903430680179,4.458323879796783] [5.928378410960896,4.671361559495923,5.615804827336681] [6.379086598050507,5.236117352535413,4.939241762551757] [7.143898356827263,5.238601582361872,5.999166631320903] [6.062878906706315,4.899350656186736,5.335564188602452] [4.509677376181927,5.5397059630207695,4.356443159059695] [8.221534386778096,6.096143979406656,6.382820608356858] [6.467137204552908,4.9723384509553314,5.769214050025613] [6.10802686564748,5.620306546348739,5.512419213600811] [4.865759068180314,4.797155378373403,4.879313314030637] [5.386156473495507,4.80565231165273,5.025999927520752] [5.441630204947418,5.140865870258252,4.65302913797015] [3.908605063576395,6.142201260616345,4.134388191048918] [5.159672871124006,6.453291723005888,5.509611872114533] [6.8069732564748255,5.1660175941518665,5.0939037292712515] [7.242056898982076,5.666501966156047,5.7895117016961235] [5.652732495300417,5.016314989388073,5.3289127307277155] [6.913171323115462,5.310198977218481,5.75782203501923] [7.143898356827263,5.238601582361872,5.999166631320903] [6.103809445425135,5.236658362287917,5.153846153846153] [5.997380057720165,5.056658573377007,5.492939496955336] [6.177790566233443,5.282671861156927,5.219892782631607] [6.048515599585123,4.776692627332796,5.31961531154936] [6.658023368943988,5.442691757677943,5.952208434427303] [7.4276042483376274,5.121482162890438,6.070805274693671] [6.939139543927204,5.05881078024343,5.553730710217646] [5.925198799318611,5.7624331428645625,5.050416607021661] [5.441630204947418,5.140865870258252,4.65302913797015] [7.026748410926976,4.49706588561911,5.568588644253617] [7.143898356827263,5.238601582361872,5.999166631320903] [6.953175686163677,5.706497380795875,5.9526488279518] [6.353385675775017,5.4599843156952605,5.713132490268117] [5.557253927835602,4.28662405936054,4.831028674320265] [4.83801632123309,4.355861678749305,4.583821965656344] [6.913454345382607,4.833999994779886,5.890269631385602] [5.313645833766918,5.091903430680179,4.458323879796783] [4.225167086264047,4.766285812465511,3.932249397506363] [8.072949241681066,5.94090830643955,5.9678324670568434] [7.268171201346202,5.729067409223204,6.216910725461044] [5.977712145590378,4.839679808936721,5.3490363505190075] [5.145237091701393,4.763014620080542,5.227255599222906] [5.022838928954571,6.230739185615,5.852400001144406] [4.8440120660349075,5.1230226381452715,4.895137412234114] [5.997806114039167,4.779638362266228,5.178893053167005] [6.9317476047973985,4.967422182880732,6.1609941692992995] [7.387364252997785,6.304851376778204,5.900080524307054] [5.862210618414071,4.354933344406316,5.339341033347545] ";
		    var array_data = responseText.split(/\s+/).slice(0,-1);
		    var mySeries = [];
		    $.each(array_data, function(index, value){
		            value = value.replace("[", "");
		            value = value.replace("]", "");
		            value = value.split(",");
		            mySeries.push([parseFloat(value[0]), parseFloat(value[1]), parseFloat(value[2])])
		    });
            display3dScatterView(mySeries);
		});
	});
});

// series data
function display3dScatterView (sdata) {
    // Give the points a 3D feel by adding a radial gradient
    Highcharts.getOptions().colors = $.map(Highcharts.getOptions().colors, function (color) {
        return {
            radialGradient: {
                cx: 0.4,
                cy: 0.3,
                r: 0.5
            },
            stops: [
                [0, color],
                [1, Highcharts.Color(color).brighten(-0.2).get('rgb')]
            ]
        };
    });

    // Set up the chart
    var chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            margin: 100,
            type: 'scatter',
            options3d: {
                enabled: true,
                alpha: 10,
                beta: 30,
                depth: 250,
                viewDistance: 5,

                frame: {
                    bottom: { size: 1, color: 'rgba(0,0,0,0.02)' },
                    back: { size: 1, color: 'rgba(0,0,0,0.04)' },
                    side: { size: 1, color: 'rgba(0,0,0,0.06)' }
                }
            }
        },
        title: {
            text: 'Draggable box'
        },
        subtitle: {
            text: 'Click and drag the plot area to rotate in space'
        },
        plotOptions: {
            scatter: {
                width: 10,
                height: 10,
                depth: 10
            }
        },
        yAxis: {
            min: 1,
            max: 9,
            title: null
        },
        xAxis: {
            min: 1,
            max: 9,
            gridLineWidth: 1
        },
        zAxis: {
            min: 1,
            max: 9
            gridLineWidth: 1
        },
        legend: {
            enabled: false
        },
        series: [{
            name: 'Reading',
            colorByPoint: true,
            data: sdata 
        }]
    });


    // Add mouse events for rotation
    $(chart.container).bind('mousedown.hc touchstart.hc', function (e) {
        e = chart.pointer.normalize(e);

        var posX = e.pageX,
            posY = e.pageY,
            alpha = chart.options.chart.options3d.alpha,
            beta = chart.options.chart.options3d.beta,
            newAlpha,
            newBeta,
            sensitivity = 5; // lower is more sensitive

        $(document).bind({
            'mousemove.hc touchdrag.hc': function (e) {
                // Run beta
                newBeta = beta + (posX - e.pageX) / sensitivity;
                newBeta = Math.min(100, Math.max(-100, newBeta));
                chart.options.chart.options3d.beta = newBeta;

                // Run alpha
                newAlpha = alpha + (e.pageY - posY) / sensitivity;
                newAlpha = Math.min(100, Math.max(-100, newAlpha));
                chart.options.chart.options3d.alpha = newAlpha;

                chart.redraw(false);
            },                            
            'mouseup touchend': function () { 
                $(document).unbind('.hc');
            }
        });
    });
}